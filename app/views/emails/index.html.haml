.page-header
  %h1 Recent emails

.btn-group
  %button.btn.dropdown-toggle(data-toggle="dropdown")
    - if @status.nil?
      All
    - elsif @status == "delivered"
      Delivered
    - elsif @status == "soft_bounce"
      Soft bounces
    - elsif @status == "hard_bounce"
      Hard bounces
    - elsif @status == "not_sent"
      Held back
    %span.caret
  %ul.dropdown-menu
    %li= link_to "All", emails_path
    %li= link_to "Delivered", emails_path(status: "delivered")
    %li= link_to "Soft bounces", emails_path(status: "soft_bounce")
    %li= link_to "Hard bounces", emails_path(status: "hard_bounce")
    %li= link_to "Held back", emails_path(status: "not_sent")

= paginated_section(@emails, inner_window: 2, outer_window: 0, previous_label: image_tag("pager/previous.png"), next_label: image_tag("pager/next.png"), renderer: BootstrapLinkRenderer, :class => "pagination")  do
  %table.table.table-striped
    %thead
      %tr
        %th To
        %th Created
        - if App.normal_apps?
          %th App
    %tbody(data-provides="rowlink")
      - @emails.each do |email|
        %tr
          %td= link_to truncate(email.to_as_string, length: 50), email_path(email), :class => "rowlink"
          %td
            = time_ago_in_words(email.created_at)
            ago
          - if App.normal_apps?
            %td= email.app.name
          %td
            = delivered_label(email.status)
            - if email.opened?
              %span.label.label-success Opened
